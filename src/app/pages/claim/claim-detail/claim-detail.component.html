<div class="w-full max-w-4xl mx-auto">
  <div class="mb-6">
    <button (click)="goBack()" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium mb-4">
      ‚Üê Back to Claims
    </button>
    <h1 class="text-xl sm:text-2xl font-semibold text-gray-800">Claim Detail</h1>
  </div>

  <div *ngIf="error" class="bg-red-50 border-l-4 border-red-500 text-red-700 px-3 py-3 rounded-r-lg mb-4 text-sm">
    {{ error }}
  </div>

  <div *ngIf="loading" class="text-gray-600">Loading...</div>

  <div *ngIf="!loading && !claim && !error" class="bg-white shadow-sm rounded-xl border border-gray-200 p-6 text-gray-600">
    Claim not found.
  </div>

  <div *ngIf="!loading && claim" class="bg-white shadow-sm rounded-xl border border-gray-200 p-6 space-y-6">
    <div class="flex flex-wrap justify-between items-start gap-4">
      <div>
        <span class="text-sm text-gray-500">Claim #</span>
        <span class="font-mono font-semibold text-lg ml-2">{{ claim.claimNumber }}</span>
      </div>
      <span class="inline-flex px-3 py-1 text-sm font-medium rounded-full" [ngClass]="getStatusClass(claim.status)">
        {{ claim.status }}
      </span>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <span class="text-sm text-gray-500">Type</span>
        <p class="font-medium">{{ claim.claimTypeName }}</p>
      </div>
      <div>
        <span class="text-sm text-gray-500">Date</span>
        <p class="font-medium">{{ claim.claimDate | date }}</p>
      </div>
      <div>
        <span class="text-sm text-gray-500">Total Amount</span>
        <p class="font-medium">{{ claim.totalAmount | number:'1.2-2' }} {{ claim.currency }}</p>
      </div>
      <div *ngIf="claim.description">
        <span class="text-sm text-gray-500">Description</span>
        <p class="font-medium">{{ claim.description }}</p>
      </div>
    </div>

    <!-- Attachments -->
    <div>
      <h3 class="text-sm font-semibold text-gray-700 mb-2">Attachments</h3>
      <div *ngIf="claim.status === 'DRAFT'" class="mb-4">
        <input type="file" id="claimFileInput" (change)="onFileSelected($event)" accept=".pdf,.jpg,.jpeg,.png,.gif,.doc,.docx" class="hidden">
        <button type="button" (click)="triggerFileInput()" [disabled]="uploading"
                class="inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50">
          <span *ngIf="!uploading">+ Add Receipt</span>
          <span *ngIf="uploading">Uploading...</span>
        </button>
      </div>
      <div *ngIf="claim.attachments && claim.attachments.length > 0" class="space-y-2">
        <div *ngFor="let att of claim.attachments" class="flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200">
          <span class="text-sm truncate flex-1">{{ att.fileName }}</span>
          <div class="flex gap-2 ml-2">
            <button (click)="downloadAttachment(att)" class="text-indigo-600 hover:text-indigo-800 text-sm">Download</button>
            <button *ngIf="claim.status === 'DRAFT'" (click)="deleteAttachment(att)" class="text-red-600 hover:text-red-800 text-sm">Remove</button>
          </div>
        </div>
      </div>
      <div *ngIf="(!claim.attachments || claim.attachments.length === 0) && claim.status !== 'DRAFT'" class="text-sm text-gray-500">
        No attachments
      </div>
    </div>

    <div *ngIf="claim.status === 'DRAFT'" class="pt-4 border-t border-gray-200">
      <button (click)="submitForApproval()" [disabled]="submitting"
              class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50">
        <span *ngIf="!submitting">Submit for Approval</span>
        <span *ngIf="submitting">Submitting...</span>
      </button>
    </div>

    <div *ngIf="claim.rejectionRemarks" class="pt-4 border-t border-gray-200">
      <span class="text-sm text-gray-500">Rejection remarks:</span>
      <p class="text-sm text-red-700 mt-1">{{ claim.rejectionRemarks }}</p>
    </div>
  </div>
</div>
